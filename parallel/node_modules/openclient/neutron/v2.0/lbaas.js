var base = require('../../client/base'),
    urljoin = require("../../client/utils").urljoin,
    error = require('../../client/error');

var LBAAS_COMPONENTS = ['vips', 'health_monitors', 'pools', 'members'];

var lbaas_coms = [];

var createLbaasManager = function (coms) {
    for (var com in LBAAS_COMPONENTS) {
        var comManager = base.Manager.extend({
            namespace: LBAAS_COMPONENTS[com],
            plural: LBAAS_COMPONENTS[com],
            error_key: "NeutronError",
            prepare_namespace: function (params) {
              return "lb/" + this.namespace;
            }
        });
        if (LBAAS_COMPONENTS[com] == "pools") {
            comManager = base.Manager.extend({
                namespace: LBAAS_COMPONENTS[com],
                plural: LBAAS_COMPONENTS[com],
                error_key: "NeutronError",
                prepare_namespace: function (params) {
                  return "lb/" + this.namespace;
                },
                assginHealthMonitor: function (params, callback) {
                    var url = urljoin(this.get_base_url(params), params.id, "health_monitors");
                    params.url = url;
                    return this.client.post(params, callback);
                }
            });
        }
        lbaas_coms.push(comManager);
    };
    return lbaas_coms;
};

module.exports = createLbaasManager;
